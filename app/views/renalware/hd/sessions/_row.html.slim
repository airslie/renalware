tr.hd-session-row(class=[session.state, stripe_class])
  td.noprint(rowspan=2)
    = link_to("Toggle",
              "#hd-session-#{session.id}",
              data: { behaviour: "toggler" })
    = pipe_separator
    = session.edit_or_view_url
  td.text-left(rowspan=2)= session.performed_on
  td= session.hospital_unit_unit_code

  td= session.start_time
  td.derived(rowspan=2)= session.duration
  td= session.before_measurement_for(:weight)
  td= session.before_measurement_for(:pulse)
  td= session.before_measurement_for(:temperature)
  td= session.before_measurement_for(:bm_stix)
  td= session.before_measurement_for(:blood_pressure)
  td(rowspan=2)= session.arterial_pressure
  td(rowspan=2)= session.venous_pressure
  td(rowspan=2)= session.blood_flow
  td(rowspan=2)= session.litres_processed
  td(rowspan=2)= session.fluid_removed
  td(rowspan=2)= session.machine_no
  td(rowspan=2)= session.machine_ktv
  td(rowspan=2)= session.machine_urr
  td.print-only(rowspan=2)
  td.print-only(rowspan=2)= session.notes
  td.print-only= session.signed_on_by


tr(class=[session.state, stripe_class])
  td= tooltip(label: session.summarised_access_used, content: session.access_used)
  td= session.end_time
  td
    = session.after_measurement_for(:weight)
    - if (change = session.change_in(:weight))
      i=" (#{change})"
  td= session.after_measurement_for(:pulse)
  td= session.after_measurement_for(:temperature)
  td= session.after_measurement_for(:bm_stix)
  td= session.after_measurement_for(:blood_pressure)
  td.print-only= session.signed_off_by
= content_tag(:tr, id: "hd-session-#{session.id}", style: "display: none")
  td(colspan=18)
    .quick-preview
      = definition_list_for(session, size: :large) do |list|
        = list.definition(:notes){ |value| simple_format(value) }
